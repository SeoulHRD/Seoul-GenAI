# 엑셀 데이터 자동 분석 및 대시보드 생성 시스템

## 1. 제품 개요

### 1.1 제품명

Excel Auto-Insight Dashboard System (EADS)

### 1.2 제품 설명

데이터 분석 지식이 없는 행정 실무자를 위한 AI 기반 엑셀 데이터 자동 분석 및 대시보드 생성 시스템. 사용자와의 대화형 인터페이스를 통해 데이터 인사이트를 능동적으로 제공하고, 최적화된 시각화를 자동으로 구현합니다.

### 1.3 대상 사용자

- **주 사용자**: 데이터 분석 경험이 없는 공무원 및 행정 실무자
- **사용 환경**: Windows 10/11, Excel 2016 이상
- **기술 수준**: 기초적인 엑셀 사용 가능

## 2. 제품 목표

### 2.1 비즈니스 목표

- 데이터 기반 의사결정 접근성 향상
- 업무 효율성 증대 (수작업 대비 90% 시간 단축)
- 데이터 분석 전문가 의존도 감소

### 2.2 사용자 목표

- 복잡한 데이터를 쉽게 이해하고 인사이트 도출
- 전문 지식 없이 대시보드 생성 및 활용
- 데이터 변경 시 자동 업데이트로 지속적 활용

## 3. 핵심 기능 요구사항

### 3.1 AI 대화형 데이터 분석

#### 기능 설명

Gemini CLI를 통한 자연어 대화 방식으로 데이터를 분석하고 인사이트를 제공

#### 상세 요구사항

- 데이터 자동 탐색 및 패턴 인식
- 사용자 수준에 맞는 쉬운 언어로 인사이트 설명
- 분석 방향을 모르는 사용자를 위한 능동적 제안
- 컨텍스트 기반 추천 시스템

#### 기술 구현 전략

- **주 도구**: Gemini CLI (자연어 처리 및 인사이트 생성)
- **보조 도구**: Codex exec (복잡한 데이터 변환 코드 생성 시)
- **데이터 접근**: oa.exe (Excel COM 인터페이스)

### 3.2 데이터 자동 정제 및 변환

#### 기능 설명

피벗테이블 생성에 부적합한 데이터를 자동으로 감지하고 변환

#### 상세 요구사항

- 병합 셀 자동 해제
- 다단계 헤더 단일화
- 교차표 형식을 세로 형식으로 변환
- 텍스트 형식 숫자 자동 변환 (통화, 쉼표, 백분율)
- 빈 행/열 자동 제거

#### 성공 기준

- 5가지 주요 데이터 문제 자동 감지율: 95% 이상
- 자동 변환 정확도: 98% 이상

### 3.3 지능형 시각화 자동 생성

#### 기능 설명

데이터 특성에 따라 최적의 피벗테이블과 차트를 자동으로 생성

#### 상세 요구사항

- 데이터 유형별 최적 차트 자동 선택
- 피벗테이블 필드 자동 배치
- 동적 피벗차트 생성 (Windows)
- 겹침 방지 자동 배치 알고리즘

#### 시각화 규칙

- **시계열 데이터** → 선 차트
- **비교 데이터** → 막대/컬럼 차트
- **비중 데이터** → 파이/도넛 차트
- **상관관계** → 분산형 차트
- **지역 데이터** → 히트맵 (가능 시)

### 3.4 인터랙티브 대시보드 구축

#### 기능 설명

생성된 분석 요소들을 하나의 대시보드 시트에 자동 구성

#### 상세 요구사항

- 대시보드 레이아웃 자동 설계
- 슬라이서 자동 생성 및 연결
- 조건부 서식 자동 적용
- 핵심 지표 카드 생성

#### 대시보드 구성 요소

- **상단**: KPI 요약 지표 (3-5개)
- **중앙**: 주요 차트 (2-3개)
- **하단**: 상세 데이터 테이블
- **우측**: 필터 슬라이서 (2-3개)

### 3.5 자동 갱신 메커니즘

#### 기능 설명

원본 데이터 변경 시 대시보드 자동 업데이트

#### 상세 요구사항

- 데이터 변경 감지
- 피벗테이블 자동 새로고침
- 차트 범위 자동 조정
- 갱신 완료 알림

## 4. 비기능 요구사항

### 4.1 성능

- **초기 분석 시작**: 10초 이내
- **대시보드 생성**: 2분 이내 (5,000행 기준)
- **데이터 갱신**: 30초 이내

### 4.2 사용성

- **사용자 개입**: 최대 3회 (확인 질문)
- **명령어 학습**: 불필요 (자연어 대화)
- **오류 시 복구 가이드**: 100% 제공

### 4.3 호환성

- **Excel 버전**: 2016, 2019, 365
- **OS**: Windows 10/11
- **Python**: 3.8 이상 (로컬 설치, 선택사항)

### 4.4 확장성

- **단일 시트**: 최대 10,000행 처리
- **다중 시트**: 최대 5개 통합 분석

## 5. 사용자 시나리오

### 5.1 초보자 시나리오

**상황**: 월별 매출 데이터 엑셀 파일을 처음 분석

```
1. 사용자: "이 엑셀 파일 분석해줘"
2. 시스템: 데이터 자동 탐색 → 인사이트 3개 제시
3. 시스템: "월별 매출이 증가 추세네요. 어떤 분석을 원하세요?"
4. 사용자: "잘 모르겠어"
5. 시스템: "지역별 매출 대시보드를 추천드려요. 만들어드릴까요?"
6. 사용자: "네"
7. 시스템: 자동으로 대시보드 생성 및 완료 알림
```

### 5.2 데이터 정제 시나리오

**상황**: 병합 셀과 다단계 헤더가 있는 복잡한 데이터

```
1. 시스템: "데이터 구조에 문제를 발견했어요"
2. 시스템: 발견된 문제 목록 표시
3. 시스템: "자동으로 정리할까요? (Y/N)"
4. 사용자: "Y"
5. 시스템: 자동 변환 실행 및 결과 보고
6. 시스템: "깔끔하게 정리됐어요! 이제 분석을 시작할게요"
```

### 5.3 대시보드 활용 시나리오

**상황**: 생성된 대시보드 사용 중

```
1. 사용자: 슬라이서로 "서울" 선택
2. 시스템: 모든 차트 자동 필터링
3. 사용자: 원본 데이터 수정
4. 시스템: "데이터가 변경되었어요. 대시보드를 업데이트했습니다"
```

## 6. 대화형 인터페이스 상세

### 6.1 AI 주도형 대화 예시

#### 데이터 발견 시

```
AI: "안녕하세요! 데이터를 살펴봤어요. 흥미로운 점을 발견했습니다:

📊 데이터 요약:

- 총 2,547행의 판매 데이터
- 2023년 1월부터 12월까지의 기록
- 5개 지역, 12개 제품 카테고리

💡 주요 인사이트:

1. 📈 4분기 매출이 전년 대비 45% 증가
2. 🏆 서울이 전체 매출의 38% 차지
3. ⚡ 온라인 채널이 오프라인을 추월

어떤 부분을 더 자세히 보시겠어요?

A) 지역별 성과 분석
B) 시간별 트렌드 분석
C) 제품 카테고리 분석
D) 잘 모르겠어요 (추천받기)"
```

#### 사용자가 모를 때

```
사용자: "D) 잘 모르겠어요"

AI: "걱정하지 마세요! 데이터를 보니 지역별 성과 차이가 크네요.
지역별 매출 대시보드를 만들어드리면 어느 지역에 집중해야 할지
한눈에 보실 수 있을 거예요. 

시작할까요? (Y/N)"
```

### 6.2 데이터 문제 해결 대화

```
AI: "데이터를 확인하는 중에 몇 가지 정리가 필요한 부분을 발견했어요:

🔍 발견된 이슈:

┌─────────────────────────────────────┐
│ ⚠️ 병합된 셀: B2:D2, F5:H5         │
│ ⚠️ 빈 행: 15행, 27행, 45행          │
│ ⚠️ 텍스트 형식 숫자: D열 전체       │
│ ⚠️ 다단계 헤더: 1-2행              │
└─────────────────────────────────────┘

이런 상태로는 정확한 분석이 어려워요.
제가 자동으로 정리해드릴까요? 원본은 백업됩니다. (Y/N)"

사용자: "Y"

AI: "정리를 시작합니다...
✅ 병합 셀 해제 완료
✅ 빈 행 제거 완료
✅ 숫자 형식 변환 완료
✅ 헤더 정리 완료

깔끔하게 정리되었어요! 이제 본격적인 분석을 시작하겠습니다."
```

## 7. 기술 구현 명세

### 7.1 oa.exe 명령어 활용

**AWLAYS** `oa excel --help` 및 `oa excel <sub-command> --help` 명령을 통해 인자를 먼저 파악해.

#### 데이터 탐색

```bash
oa excel workbook-list        # 열린 파일 확인
oa excel table-list           # 테이블 구조 파악
oa excel data-analyze --range "A1:Z1000" --expand table
```

#### 데이터 변환

```bash
oa excel data-transform --source-range "A1:Z100" --transform-type "auto" --output-sheet "CleanData"
oa excel range-convert --range "D2:F100" --remove-currency --remove-comma
```

#### 피벗테이블 생성

```bash
oa excel pivot-create --source-range "CleanData!A1:K999" --expand table --dest-sheet "피벗" --auto-position
oa excel pivot-configure --pivot-name "PivotTable1" --row-fields "지역" --value-fields "매출:Sum" --clear-existing
```

#### 차트 생성

```bash
oa excel chart-add --data-range "A1:C10" --chart-type "column" --title "지역별 매출" --auto-position
oa excel chart-pivot-create --pivot-name "PivotTable1" --chart-type "line" --title "트렌드 분석"

```


### 7.2 AI 도구 통합



#### Gemini CLI 활용

- **역할**: 데이터 해석, 인사이트 생성, 사용자 대화
- **명령**: `gemini -p "프롬프트"`
- **응답 시간**: 5-10초


#### Codex exec 활용

- **역할**: 복잡한 데이터 변환 코드 생성
- **명령**: `codex exec "코드 생성 요청"`
- **사용 조건**: Gemini가 판단하여 필요시 호출


## 8. 제약사항 및 가정

### 8.1 제약사항

- **외부 API 접근**: 워크샵 환경에서만 가능 (실무 환경에서는 제한)
- **VBA 매크로**: 보안 정책상 제한될 수 있음
- **실시간 협업**: 지원하지 않음
- **클라우드 저장**: 로컬 파일만 지원


### 8.2 가정

- 사용자 PC에 oa.exe 사전 설치
- Excel COM 객체 접근 가능
- 최소 하나의 AI CLI 도구 사용 가능
- 워크샵 기간 중 인터넷 접근 가능

## 9. 성공 지표

### 9.1 정량적 지표

| 지표 | 목표값 | 측정 방법 |
|------|--------|-----------|
| 분석 소요 시간 | 기존 대비 90% 단축 | 작업 시작-완료 시간 |
| 자동화율 | 85% 이상 | 자동/수동 작업 비율 |
| 오류 발생률 | 5% 이하 | 오류/전체 실행 횟수 |
| 처리 가능 데이터 | 10,000행 | 최대 처리 행 수 |


### 9.2 정성적 지표

| 지표 | 목표 | 평가 방법 |
|------|------|-----------|
| 사용자 만족도 | 4.0/5.0 이상 | 설문조사 |
| 학습 용이성 | 30분 이내 습득 | 교육 시간 측정 |
| 활용 빈도 | 주 3회 이상 | 사용 로그 분석 |
| 인사이트 유용성 | 80% 이상 유용 | 사용자 피드백 |


## 10. 시스템 환경 구성

### 10.1 AI CLI 도구 경로 관리

#### 도구 위치 자동 탐색

시스템은 AI CLI 도구(Codex, Gemini, Claude)를 다음 순서로 자동 탐색합니다:

1. **시스템 PATH** - 환경변수에 등록된 경로
2. **NPM 전역 설치 경로** - `%APPDATA%\\npm\\` (Windows 표준 경로)
3. **사용자별 NPM 경로** - `%USERPROFILE%\\AppData\\Roaming\\npm\\`

#### 도구 실행 전략

- **우선순위**: Gemini CLI → Codex CLI → Claude Code
- **폴백 메커니즘**: 기본 도구 실패 시 다음 순위 도구로 자동 전환
- **경로 캐싱**: 최초 탐색 후 config.json에 저장하여 재탐색 방지

### 10.2 필수 구성요소 검증

#### 시작 시 자동 검증 항목

1. **oa.exe** - `C:\\windows\\oa.exe` 또는 PATH 등록 확인
2. **AI CLI 도구** - 최소 1개 이상 사용 가능 확인
3. **Python** - 데이터 분석용 (선택사항)
4. **Excel** - COM 객체 접근 가능 여부

#### 환경 설정 파일 (config.json)

시스템 초기화 시 자동 생성되며 다음 정보를 포함:

- 탐색된 도구 경로
- 기본 AI 도구 지정
- Excel 버전 정보
- 사용자 설정

### 10.3 문제 해결

#### AI CLI 도구 미발견 시

- NPM 설치 상태 확인: `npm list -g`
- 수동 PATH 추가: `setx PATH "%PATH%;%APPDATA%\\npm"`
- 직접 경로 지정: config.json에서 수동 설정

#### Python 미발견 시

- 자동 탐색 경로: Anaconda, Python 3.8+의 일반적 설치 위치
- 필수 요구사항 아님 (선택적 고급 분석용)

### 10.4 사용자 알림 메시지

```
🔍 시스템 환경 확인 완료
✅ oa.exe: 정상
✅ AI 도구: Gemini CLI (기본)
⚠️ Python: 미설치 (고급 분석 제한)
📁 설정 저장: config.json
```

#### 도구 실행 실패 시

```
⚠️ Gemini CLI 응답 실패
🔄 Codex CLI로 재시도 중...
✅ 대체 도구로 정상 처리됨
```

## 11. 용어 정의

| 용어 | 설명 |
|------|------|
| **oa.exe** | Excel COM 인터페이스 접근 CLI 도구 |
| **Gemini CLI** | Google AI 자연어 처리 명령줄 도구 |
| **Codex exec** | OpenAI 코드 생성 명령줄 도구 |
| **피벗테이블** | 데이터 요약 분석을 위한 동적 테이블 |
| **슬라이서** | 피벗테이블/차트용 대화형 필터 컨트롤 |
| **KPI** | 핵심 성과 지표 (Key Performance Indicator) |
| **COM 객체** | Windows Component Object Model |
| **데이터 변환** | 원시 데이터를 분석 가능한 형태로 변경 |
| **대시보드** | 데이터 시각화 요약 화면 |


## 12. 참고사항

### 12.1 개발 철학

본 시스템은 "AI가 사용자를 이끄는" 철학으로 설계되었습니다. 사용자가 데이터 분석 지식이 없어도 AI가 능동적으로 안내하여 유용한 인사이트를 얻을 수 있도록 합니다.

### 12.2 확장 가능성

- **Phase 1**: 단일 엑셀 파일 분석 (현재 범위)
- **Phase 2**: 다중 파일 통합 분석
- **Phase 3**: 자동 보고서 생성
- **Phase 4**: 예측 분석 기능

### 12.3 라이선스 및 의존성

- **oa.exe**: pyhub-office-automation 프로젝트 (MIT License)
- **Excel**: Microsoft Office 라이선스 필요
- **AI CLI 도구**: 각 제공사 이용약관 준수


### 12.4 보안 고려사항

- 민감 데이터는 로컬에서만 처리
- AI API 호출 시 개인정보 제외
- 워크샵 종료 후 실무 환경에서는 로컬 AI 모델 고려
